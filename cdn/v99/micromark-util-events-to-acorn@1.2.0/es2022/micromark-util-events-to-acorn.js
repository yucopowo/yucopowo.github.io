/* esm.sh - esbuild bundle(micromark-util-events-to-acorn@1.2.0) es2022 production */import{visit as $}from"/cdn/v99/estree-util-visit@1.2.0/es2022/estree-util-visit.js";import{VFileMessage as B}from"/cdn/v99/vfile-message@3.1.3/es2022/vfile-message.js";import{location as F}from"/cdn/v99/vfile-location@4.0.1/es2022/vfile-location.js";function V(x,s){let{prefix:m="",suffix:A=""}=s,E=Object.assign({},s.acornOptions),g=[],P=[],h=E.onComment,d=E.onToken,S=Object.assign({},E,{onComment:g,onToken:d?P:void 0,preserveParens:!0}),b=[],c={},v=-1,C=!1,o,p,i;for(s.start&&(i=s.start.line,c[i]=s.start);++v<x.length;){let[e,t,n]=x[v];e==="exit"&&(b.push(n.sliceSerialize(t)),j(t.start),j(t.end))}let r=b.join(""),y=m+r+A,w=s.expression&&k(r),z=F(r);if(w&&!s.allowEmpty)throw new B("Unexpected empty expression",u(0),"micromark-extension-mdx-expression:unexpected-empty-expression");try{o=s.expression&&!w?s.acorn.parseExpressionAt(y,0,S):s.acorn.parse(y,S)}catch(e){let t=e,n=u(t.pos);t.message=String(t.message).replace(/ \(\d+:\d+\)$/,""),t.pos=n.offset,t.loc={line:n.line,column:n.column-1},p=t,C=t.raisedAt>=m.length+r.length||t.message==="Unterminated comment"}if(o&&s.expression&&!w)if(k(y.slice(o.end,y.length-A.length)))o={type:"Program",start:0,end:m.length+r.length,body:[{type:"ExpressionStatement",expression:o,start:0,end:m.length+r.length}],sourceType:"module",comments:[]};else{let e=u(o.end);p=new Error("Unexpected content after expression"),p.pos=e.offset,p.loc={line:e.line,column:e.column-1},o=void 0}if(o){if(o.comments=g,$(o,(e,t,n,l)=>{let f=l[l.length-1],a=t;e.type==="ParenthesizedExpression"&&f&&a&&(typeof n=="number"&&(f=f[a],a=n),f[a]=e.expression),U(e)}),Array.isArray(h))h.push(...g);else if(typeof h=="function")for(let e of g)h(e.type==="Block",e.value,e.start,e.end,e.loc.start,e.loc.end);for(let e of P)U(e),Array.isArray(d)?d.push(e):d(e)}return{estree:o,error:p,swallow:C};function U(e){let t=u(e.start),n=u(e.end);e.start=t.offset,e.end=n.offset,e.loc={start:{line:t.line,column:t.column-1,offset:t.offset},end:{line:n.line,column:n.column-1,offset:n.offset}},e.range=[e.start,e.end]}function u(e){let t=e-m.length;t<0?t=0:t>r.length&&(t=r.length);let n=z.toPoint(t),l=i+(n.line-1),f=c[l].column+(n.column-1),a=c[l].offset+(n.column-1);return{line:l,column:f,offset:a}}function j(e){(!i||e.line<i)&&(i=e.line),(!(e.line in c)||c[e.line].offset>e.offset)&&(c[e.line]=e)}}function k(x){return /^\s*$/.test(x.replace(/\/\*[\s\S]*?\*\//g,"").replace(/\/\/[^\r\n]*(\r\n|\n|\r)/g,""))}export{V as eventsToAcorn};