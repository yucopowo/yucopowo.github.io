/* esm.sh - esbuild bundle(parse-entities@4.0.0) es2022 production */import{characterEntitiesLegacy as T}from"/cdn/v99/character-entities-legacy@3.0.0/es2022/character-entities-legacy.js";import{characterReferenceInvalid as D}from"/cdn/v99/character-reference-invalid@2.0.1/es2022/character-reference-invalid.js";import{isDecimal as U}from"/cdn/v99/is-decimal@2.0.1/es2022/is-decimal.js";import{isHexadecimal as z}from"/cdn/v99/is-hexadecimal@2.0.1/es2022/is-hexadecimal.js";import{isAlphanumerical as H}from"/cdn/v99/is-alphanumerical@2.0.1/es2022/is-alphanumerical.js";import{decodeNamedCharacterReference as L}from"/cdn/v99/decode-named-character-reference@1.0.2/es2022/decode-named-character-reference.js";var N=String.fromCharCode,B=["","Named character references must be terminated by a semicolon","Numeric character references must be terminated by a semicolon","Named character references cannot be empty","Numeric character references cannot be empty","Named character references must be known","Numeric character references cannot be disallowed","Numeric character references cannot be outside the permissible Unicode range"];function F(t,r={}){let k=typeof r.additional=="string"?r.additional.charCodeAt(0):r.additional,R=[],o=0,I=-1,h="",d,E;r.position&&("start"in r.position||"indent"in r.position?(E=r.position.indent,d=r.position.start):d=r.position);let j=(d?d.line:0)||1,x=(d?d.column:0)||1,y=w(),u;for(o--;++o<=t.length;)if(u===10&&(x=(E?E[I]:0)||1),u=t.charCodeAt(o),u===38){let f=t.charCodeAt(o+1);if(f===9||f===10||f===12||f===32||f===38||f===60||Number.isNaN(f)||k&&f===k){h+=N(u),x++;continue}let l=o+1,s=l,n=l,a;if(f===35){n=++s;let e=t.charCodeAt(n);e===88||e===120?(a="hexadecimal",n=++s):a="decimal"}else a="named";let p="",g="",i="",S=a==="named"?H:a==="decimal"?U:z;for(n--;++n<=t.length;){let e=t.charCodeAt(n);if(!S(e))break;i+=N(e),a==="named"&&T.includes(i)&&(p=i,g=L(i))}let C=t.charCodeAt(n)===59;if(C){n++;let e=a==="named"?L(i):!1;e&&(p=i,g=e)}let m=1+n-l,b="";if(!(!C&&r.nonTerminated===!1))if(!i)a!=="named"&&c(4,m);else if(a==="named"){if(C&&!g)c(5,1);else if(p!==i&&(n=s+p.length,m=1+n-s,C=!1),!C){let e=p?1:3;if(r.attribute){let A=t.charCodeAt(n);A===61?(c(e,m),g=""):H(A)?g="":c(e,m)}else c(e,m)}b=g}else{C||c(2,m);let e=Number.parseInt(i,a==="hexadecimal"?16:10);if(G(e))c(7,m),b=N(65533);else if(e in D)c(6,m),b=D[e];else{let A="";J(e)&&c(6,m),e>65535&&(e-=65536,A+=N(e>>>10|55296),e=56320|e&1023),b=A+N(e)}}if(b){q(),y=w(),o=n-1,x+=n-l+1,R.push(b);let e=w();e.offset++,r.reference&&r.reference.call(r.referenceContext,b,{start:y,end:e},t.slice(l-1,n)),y=e}else i=t.slice(l-1,n),h+=i,x+=i.length,o=n-1}else u===10&&(j++,I++,x=0),Number.isNaN(u)?q():(h+=N(u),x++);return R.join("");function w(){return{line:j,column:x,offset:o+((d?d.offset:0)||0)}}function c(f,l){let s;r.warning&&(s=w(),s.column+=l,s.offset+=l,r.warning.call(r.warningContext,B[f],s,f))}function q(){h&&(R.push(h),r.text&&r.text.call(r.textContext,h,{start:y,end:w()}),h="")}}function G(t){return t>=55296&&t<=57343||t>1114111}function J(t){return t>=1&&t<=8||t===11||t>=13&&t<=31||t>=127&&t<=159||t>=64976&&t<=65007||(t&65535)===65535||(t&65535)===65534}export{F as parseEntities};