# autojs 企业微信定时打卡

autojs 企业微信定时打卡

## 123 

```javascript {filename=common.js}

const APP_NAME = "com.tencent.wework";

function sleepRandom() {

    const m = Math.floor(1 + Math.random() * 10 );
    // const m = 1;
    const s = m * 60;
    const time = s * 1000;
    console.log('随机延迟' + m + '分钟' + ' 或'+s+'秒');

    sleep(time);
}

function killApp() {
    const name = APP_NAME;
    app.openAppSetting(name);
    sleep(3000);
    //通过包名打开应用的详情页(设置页)
    text(app.getAppName(name)).waitFor();
    //通过包名获取已安装的应用名称，判断是否已经跳转至该app的应用设置界面
    sleep(500);
    //稍微休息一下，不然看不到运行过程，自己用时可以删除这行
    let is_sure = textMatches(/(.*强.*|.*停.*|.*结.*)/).findOne();
    // console.log(is_sure);
    //在app的应用设置界面找寻包含“强”，“停”，“结”，“行”的控件
    //特别注意，应用设置界面可能存在并非关闭该app的控件，但是包含上述字样的控件，如果某个控件包含名称“行”字
    //textMatches(/(.*强.*|.*停.*|.*结.*|.*行.*)/)改为textMatches(/(.*强.*|.*停.*|.*结.*)/)
    //或者结束应用的控件名为“结束运行”直接将textMatches(/(.*强.*|.*停.*|.*结.*|.*行.*)/)改为text("结束运行")
    if (is_sure.enabled()) {
        //判断控件是否已启用（想要关闭的app是否运行）
        is_sure.parent().click();
        is_sure.click();
        //结束应用的控件如果无法点击，需要在布局中找寻它的父控件，如果还无法点击，再上一级控件，本案例就是控件无法点击
        textMatches(/(.*确.*|.*定.*)/)
            .findOne()
            .click();
        //需找包含“确”，“定”的控件
        toast(app.getAppName(name) + "应用已被关闭");
        sleep(1000);
        // back();
    } else {
        toast(app.getAppName(name) + "应用不能被正常关闭或不在后台运行");
        // back();
    }
}


function startAutoClock() {
    console.log('开始打卡...');
    // sleepRandom();
    if(!device.isScreenOn()) {
        // device.keepScreenOn(60 * 1000);
        device.wakeUp();
    }
    home();
    swipe(500, 2000, 500, 1000, 210);
    home();
    swipe(500, 2000, 500, 1000, 210);
    sleep(5*1000);
    launch(APP_NAME);
    sleep(10*1000);
    home();
    console.log('自动打卡结束');
    sleep(5*1000);
}

function stopAutoClock() {
    killApp();
    home();
    sleep(5*1000);
    device.cancelKeepingAwake();
}

module.exports = {
    startAutoClock,
    stopAutoClock,
}



```



```javascript {filename=main.js}


const common = require('./common.js');

const time = '08:15';
// console.show();

toast(time+' 任务开始');
console.log(time+' 任务开始');

common.startAutoClock();


toast(time+' 任务结束');
console.log(time+' 任务结束');

common.stopAutoClock();




```
